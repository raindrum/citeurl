<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Functions - CiteURL</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Functions", url: "#_top", children: [
              {title: "insert_links()", url: "#insert_links" },
              {title: "list_authorities()", url: "#list_authorities" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../schema-yamls/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../schema-yamls/" class="btn btn-xs btn-link">
        Writing Your Own Schemas
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../classes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../classes/" class="btn btn-xs btn-link">
        Classes
      </a>
    </div>
    
  </div>

    

    <h1 id="functions">Functions</h1>
<p>Most of CiteURL's core features can be accessed through the Citator class. But if you plan to perform multiple operations with the same set of citations, you can use these module-wide functions without generating a whole new list of citations every time.</p>
<h2 id="insert_links">insert_links()</h2>
<div class="doc doc-object doc-function">
<h3 class="hidden-toc" id="citeurl.insert_links" style="visibility: hidden; position: absolute;">
        </h3>
<div class="doc doc-contents first">
<p>Given a text and a list of citations found in it, return a text
with an HTML hyperlink inserted for each citation.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>citations</code></td>
<td><code>list</code></td>
<td>
<p>A list of citation objects found in the text</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>The text the citations were found in</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code>dict</code></td>
<td>
<p>HTML tag attributes (like css class, rel, etc)
to give each inserted hyperlink.</p>
</td>
<td><code>{'class': 'citation'}</code></td>
</tr>
<tr>
<td><code>link_detailed_ids</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert hyperlinks for citations
like "Id. at 30."</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>link_plain_ids</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert hyperlinks for simple repeat
citations like "id."</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>url_optional</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert link elements for citations that
do not have an associated URL</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>str</code></td>
<td>
<p>The input text, with HTML links inserted for each citation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">insert_links</span><span class="p">(</span>
    <span class="n">citations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">},</span>
    <span class="n">link_detailed_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">link_plain_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">url_optional</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Given a text and a list of citations found in it, return a text</span>
<span class="sd">    with an HTML hyperlink inserted for each citation.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        citations: A list of citation objects found in the text</span>
<span class="sd">        text: The text the citations were found in</span>
<span class="sd">        attrs: HTML tag attributes (like css class, rel, etc)</span>
<span class="sd">            to give each inserted hyperlink.</span>
<span class="sd">        link_detailed_ids: Whether to insert hyperlinks for citations</span>
<span class="sd">            like "Id. at 30."</span>
<span class="sd">        link_plain_ids: Whether to insert hyperlinks for simple repeat</span>
<span class="sd">            citations like "id."</span>
<span class="sd">        url_optional: Whether to insert link elements for citations that</span>
<span class="sd">            do not have an associated URL</span>
<span class="sd">    Returns:</span>
<span class="sd">        The input text, with HTML links inserted for each citation</span>
<span class="sd">    """</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">citation</span><span class="o">.</span><span class="n">URL</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">url_optional</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">citation</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">is_id</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">citation</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">_compiled_re</span><span class="p">()</span><span class="o">.</span><span class="n">groupindex</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">link_detailed_ids</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">link_plain_ids</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">get_link</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">)</span>
        <span class="n">cite_start</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="n">cite_end</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">text</span><span class="p">[:</span><span class="n">cite_start</span><span class="p">],</span> <span class="n">link</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">cite_end</span><span class="p">:]])</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">link</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">citation</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre>
</div>
</details>
</div>
</div>
<h2 id="list_authorities">list_authorities()</h2>
<div class="doc doc-object doc-function">
<h3 class="hidden-toc" id="citeurl.list_authorities" style="visibility: hidden; position: absolute;">
        </h3>
<div class="doc doc-contents first">
<p>Combine a list of citations into a list of authorities, each
of which represents all the citations to a particular source.</p>
<p>As a side-effect, this also gives each citation an <code>authority</code>
attribute referring to the proper authority.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>citations</code></td>
<td><code>list</code></td>
<td>
<p>The list of citations to combine</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>unimportant_tokens</code></td>
<td><code></code></td>
<td>
<p>A list of tokens whose values may 
differ among citations to the same authority.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>A list of authority objects, sorted by the number of citations
that refer to each, from most to least.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">list_authorities</span><span class="p">(</span>
    <span class="n">citations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> 
    <span class="n">irrelevant_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="n">NON_AUTHORITY_TOKENS</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Combine a list of citations into a list of authorities, each</span>
<span class="sd">    of which represents all the citations to a particular source.</span>

<span class="sd">    As a side-effect, this also gives each citation an `authority`</span>
<span class="sd">    attribute referring to the proper authority.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        citations: The list of citations to combine</span>
<span class="sd">        unimportant_tokens: A list of tokens whose values may </span>
<span class="sd">            differ among citations to the same authority.</span>
<span class="sd">    Returns:</span>
<span class="sd">        A list of authority objects, sorted by the number of citations</span>
<span class="sd">        that refer to each, from most to least.</span>
<span class="sd">    """</span>
    <span class="n">authorities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authority</span> <span class="ow">in</span> <span class="n">authorities</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">authority</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">citation</span><span class="p">):</span>
                <span class="n">authority</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">authorities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Authority</span><span class="p">(</span><span class="n">citation</span><span class="p">,</span> <span class="n">irrelevant_tokens</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">authority_sort_key</span><span class="p">(</span><span class="n">authority</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">authority</span><span class="o">.</span><span class="n">citations</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">authorities</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">authority_sort_key</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../schema-yamls/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../schema-yamls/" class="btn btn-xs btn-link">
        Writing Your Own Schemas
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../classes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../classes/" class="btn btn-xs btn-link">
        Classes
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>