
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>Library Reference - CiteURL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="pink">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#library-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="CiteURL" class="md-header-nav__button md-logo" aria-label="CiteURL">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            CiteURL
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Library Reference
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/raindrum/citeurl/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CiteURL" class="md-nav__button md-logo" aria-label="CiteURL">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    CiteURL
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/raindrum/citeurl/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../frontends/" class="md-nav__link">
        CiteURL Frontends
      </a>
    </li>
  

    
      
      
      


  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Library Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Library Reference
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#citator" class="md-nav__link">
    Citator
  </a>
  
    <nav class="md-nav" aria-label="Citator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.insert_links" class="md-nav__link">
    insert_links()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.list_authorities" class="md-nav__link">
    list_authorities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.list_citations" class="md-nav__link">
    list_citations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.load_yaml" class="md-nav__link">
    load_yaml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.lookup" class="md-nav__link">
    lookup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
    <nav class="md-nav" aria-label="Template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.get_citations" class="md-nav__link">
    get_citations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.lookup" class="md-nav__link">
    lookup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation" class="md-nav__link">
    Citation
  </a>
  
    <nav class="md-nav" aria-label="Citation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Citation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citation.get_link" class="md-nav__link">
    get_link()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authority" class="md-nav__link">
    Authority
  </a>
  
    <nav class="md-nav" aria-label="Authority">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.include" class="md-nav__link">
    include()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.matches" class="md-nav__link">
    matches()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert_links" class="md-nav__link">
    insert_links()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list_authorities" class="md-nav__link">
    list_authorities()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../template-yamls/" class="md-nav__link">
        Writing Your Own Templates
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#citator" class="md-nav__link">
    Citator
  </a>
  
    <nav class="md-nav" aria-label="Citator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.insert_links" class="md-nav__link">
    insert_links()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.list_authorities" class="md-nav__link">
    list_authorities()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.list_citations" class="md-nav__link">
    list_citations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.load_yaml" class="md-nav__link">
    load_yaml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citator.lookup" class="md-nav__link">
    lookup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
    <nav class="md-nav" aria-label="Template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.get_citations" class="md-nav__link">
    get_citations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Template.lookup" class="md-nav__link">
    lookup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation" class="md-nav__link">
    Citation
  </a>
  
    <nav class="md-nav" aria-label="Citation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Citation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Citation.get_link" class="md-nav__link">
    get_link()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authority" class="md-nav__link">
    Authority
  </a>
  
    <nav class="md-nav" aria-label="Authority">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.include" class="md-nav__link">
    include()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#citeurl.Authority.matches" class="md-nav__link">
    matches()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#insert_links" class="md-nav__link">
    insert_links()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list_authorities" class="md-nav__link">
    list_authorities()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/raindrum/citeurl/edit/master/docs_source/library.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="library-reference">Library Reference</h1>
<p>This page documents how to include CiteURL in your Python programming projects.</p>
<p>The first step is to instantiate a <a href="#citator">Citator</a>, which by default contains all of CiteURL's built-in <a href="#templates">Templates</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">citeurl</span> <span class="kn">import</span> <span class="n">Citator</span>
<span class="n">citator</span> <span class="o">=</span> <span class="n">Citator</span><span class="p">()</span>
</code></pre></div>
<p>After that, you can feed it text to return a list of <a href="#citation">Citations</a> it finds:</p>
<div class="highlight"><pre><span></span><code><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Federal law provides that courts should award prevailing civil rights plaintiffs reasonable attorneys fees, 42 USC § 1988(b), and, by discretion, expert fees, id. at (c). This is because the importance of civil rights litigation cannot be measured by a damages judgment. See Riverside v. Rivera, 477 U.S. 561 (1986). But Evans v. Jeff D. upheld a settlement where the plaintiffs got everything they wanted, on condition that they waive attorneys&#39; fees. 475 U.S. 717 (1986). This ruling lets savvy defendants create a wedge between plaintiffs and their attorneys, discouraging civil rights suits and undermining the court&#39;s logic in Riverside, 477 U.S. at 574-78.</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">citations</span> <span class="o">=</span> <span class="n">citator</span><span class="o">.</span><span class="n">list_citations</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
<p>Once you have a list of citations, you can get information about each one:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">citations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="c1"># 42 USC § 1988(b)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">citations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
<span class="c1"># {&#39;title&#39;: &#39;42&#39;, &#39;section&#39;: &#39;1988&#39;, &#39;subsection&#39;: &#39;(b)&#39;}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">citations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">URL</span><span class="p">)</span>
<span class="c1"># https://www.law.cornell.edu/uscode/text/42/1988#b</span>
</code></pre></div>
<p>You can also use <a href="#insert_links">insert_links()</a> to insert the citations back into the source text as HTML hyperlinks:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">citeurl</span> <span class="kn">import</span> <span class="n">insert_links</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">insert_links</span><span class="p">(</span><span class="n">citations</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</code></pre></div>
<p>Or, you can use <a href="#list_authorities">list_authorities()</a> to combine all the citations into a list of all the authorities cited in the text:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">citeurl</span> <span class="kn">import</span> <span class="n">list_authorities</span>

<span class="n">authorities</span> <span class="o">=</span> <span class="n">list_authorities</span><span class="p">(</span><span class="n">citations</span><span class="p">)</span>
<span class="k">for</span> <span class="n">authority</span> <span class="ow">in</span> <span class="n">authorities</span><span class="p">:</span>
    <span class="n">auth_cites</span> <span class="o">=</span> <span class="n">authority</span><span class="o">.</span><span class="n">citations</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">authority</span><span class="si">}</span><span class="s2"> was cited </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">auth_cites</span><span class="p">)</span><span class="si">}</span><span class="s2"> time(s)&quot;</span><span class="p">)</span>

<span class="c1"># 42 USC § 1988 was cited 2 time(s)</span>
<span class="c1"># 477 U.S. 561 was cited 2 time(s)</span>
<span class="c1"># 475 U.S. 717 was cited 1 time(s)</span>
</code></pre></div>
<h2 id="citator">Citator</h2>
<div class="doc doc-object doc-class">
<div class="doc doc-contents first">
<p>CiteURL's main feature: a collection of templates, and the tools
to apply them to text, to find all kinds of citations in a text.</p>
<p><strong>Attributes:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>templates</code></td>
<td><code>list</code></td>
<td>
<p>A list of template objects that this citator will try to
match against.</p>
</td>
</tr>
<tr>
<td><code>generic_id</code></td>
<td><code>str</code></td>
<td>
<p>A common regex the citator will append to each
template when it is loaded, to recognize a simple citation to
the most-recently cited source.</p>
</td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.__init__">

<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaml_paths</span><span class="o">=</span><span class="p">[],</span> <span class="n">defaults</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">generic_id</span><span class="o">=</span><span class="s1">'</span><span class="se">\\</span><span class="s1">b(Ib)?[Ii]d</span><span class="se">\\</span><span class="s1">.(&lt;</span><span class="se">\\</span><span class="s1">/(i|em|u)&gt;)?'</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h3>
<div class="doc doc-contents ">
<p>Calls load_yaml one or more times, to load the citator with
templates.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>defaults</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to load CiteURL's default templates</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>yaml_paths</code></td>
<td><code>list</code></td>
<td>
<p>paths to additional YAML files with templates that
should be loaded to supplement or replace the defaults.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>generic_id</code></td>
<td><code>str</code></td>
<td>
<p>a common regex to append to all templates, to
recognize a simple citation to the most-recently cited
source. Detects "id." or "ibid." by default. To
disable, set to None.</p>
</td>
<td><code>'\\b(Ib)?[Ii]d\\.(&lt;\\/(i|em|u)&gt;)?'</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">yaml_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">generic_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">GENERIC_ID</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Calls load_yaml one or more times, to load the citator with</span>
<span class="sd">    templates.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        defaults: Whether to load CiteURL's default templates</span>
<span class="sd">        yaml_paths: paths to additional YAML files with templates that</span>
<span class="sd">            should be loaded to supplement or replace the defaults.</span>
<span class="sd">        generic_id: a common regex to append to all templates, to</span>
<span class="sd">            recognize a simple citation to the most-recently cited</span>
<span class="sd">            source. Detects "id." or "ibid." by default. To</span>
<span class="sd">            disable, set to None.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generic_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">generic_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">templates</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">defaults</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_yaml</span><span class="p">(</span><span class="n">DEFAULT_YAML_PATH</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">yaml_paths</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_yaml</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.insert_links">

<code class="highlight language-python"><span class="n">insert_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">},</span> <span class="n">url_optional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">link_detailed_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">link_plain_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">id_break_regex</span><span class="o">=</span><span class="s1">'L</span><span class="se">\\</span><span class="s1">. ?Rev</span><span class="se">\\</span><span class="s1">.|J</span><span class="se">\\</span><span class="s1">. ?Law|</span><span class="se">\\</span><span class="s1">. ?([Cc]ode|[Cc]onst)'</span><span class="p">,</span> <span class="n">id_break_indices</span><span class="o">=</span><span class="p">[])</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Convenience method to return a copy of the given text, with
citation hyperlinks inserted.</p>
<p>If you plan to do more than just insert links, it's better to
get a list of citations with list_citations first, then insert
those links with the module-wide insert_links function.</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">insert_links</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">},</span>
    <span class="n">url_optional</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">link_detailed_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">link_plain_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">id_break_regex</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">DEFAULT_ID_BREAKS</span><span class="p">,</span>
    <span class="n">id_break_indices</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Convenience method to return a copy of the given text, with</span>
<span class="sd">    citation hyperlinks inserted.</span>

<span class="sd">    If you plan to do more than just insert links, it's better to</span>
<span class="sd">    get a list of citations with list_citations first, then insert</span>
<span class="sd">    those links with the module-wide insert_links function.</span>
<span class="sd">    """</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_citations</span><span class="p">(</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">id_break_regex</span><span class="o">=</span><span class="n">id_break_regex</span><span class="p">,</span>
        <span class="n">id_break_indices</span><span class="o">=</span><span class="n">id_break_indices</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">insert_links</span><span class="p">(</span>
        <span class="n">citations</span><span class="p">,</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
        <span class="n">link_detailed_ids</span><span class="o">=</span><span class="n">link_detailed_ids</span><span class="p">,</span>
        <span class="n">link_plain_ids</span><span class="o">=</span><span class="n">link_plain_ids</span><span class="p">,</span>
        <span class="n">url_optional</span><span class="o">=</span><span class="n">url_optional</span>
    <span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.list_authorities">

<code class="highlight language-python"><span class="n">list_authorities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Convenience method to list all the authorities cited in a
given text.</p>
<p>If you plan to do more than list authorities, it's better to
get a list of citations with list_citations, then list the
unique authorities with the module-wide list_authorities
function.</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">list_authorities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Convenience method to list all the authorities cited in a</span>
<span class="sd">    given text.</span>

<span class="sd">    If you plan to do more than list authorities, it's better to</span>
<span class="sd">    get a list of citations with list_citations, then list the</span>
<span class="sd">    unique authorities with the module-wide list_authorities</span>
<span class="sd">    function.</span>
<span class="sd">    """</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_citations</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list_authorities</span><span class="p">(</span><span class="n">citations</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.list_citations">

<code class="highlight language-python"><span class="n">list_citations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">id_forms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">id_break_regex</span><span class="o">=</span><span class="s1">'L</span><span class="se">\\</span><span class="s1">. ?Rev</span><span class="se">\\</span><span class="s1">.|J</span><span class="se">\\</span><span class="s1">. ?Law|</span><span class="se">\\</span><span class="s1">. ?([Cc]ode|[Cc]onst)'</span><span class="p">,</span> <span class="n">id_break_indices</span><span class="o">=</span><span class="p">[])</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Scan a text and return a list of all citations in it, in
order of appearance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id_forms</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to detect citations like "Id." and
"Id. at 30."</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>id_break_regex</code></td>
<td><code>str</code></td>
<td>
<p>A pattern to look for in the text. Any
occurrence of the pattern will interrupt a chain of
"id." citations as if it were another citation.</p>
</td>
<td><code>'L\\. ?Rev\\.|J\\. ?Law|\\. ?([Cc]ode|[Cc]onst)'</code></td>
</tr>
<tr>
<td><code>id_break_indices</code></td>
<td><code>list</code></td>
<td>
<p>A list of positions in the text
where "id." citations should be interrupted</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>A list of citation objects, in order of appearance in the
text.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">list_citations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">id_forms</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">id_break_regex</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">DEFAULT_ID_BREAKS</span><span class="p">,</span>
    <span class="n">id_break_indices</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Scan a text and return a list of all citations in it, in</span>
<span class="sd">    order of appearance.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        id_forms: Whether to detect citations like "Id." and</span>
<span class="sd">            "Id. at 30."</span>
<span class="sd">        id_break_regex: A pattern to look for in the text. Any</span>
<span class="sd">            occurrence of the pattern will interrupt a chain of</span>
<span class="sd">            "id." citations as if it were another citation.</span>
<span class="sd">        id_break_indices: A list of positions in the text</span>
<span class="sd">            where "id." citations should be interrupted</span>
<span class="sd">    Returns:</span>
<span class="sd">        A list of citation objects, in order of appearance in the</span>
<span class="sd">        text.</span>
<span class="sd">    """</span>
    <span class="c1"># First, get full citations:</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">template</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">templates</span><span class="p">:</span>
        <span class="n">citations</span> <span class="o">+=</span> <span class="n">template</span><span class="o">.</span><span class="n">get_citations</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">shortform_cites</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Then, add shortforms</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="n">shortform_cites</span> <span class="o">+=</span> <span class="n">citation</span><span class="o">.</span><span class="n">_get_shortform_citations</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">citations</span> <span class="o">+=</span> <span class="n">shortform_cites</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="n">_sort_and_remove_overlaps</span><span class="p">(</span><span class="n">citations</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">id_forms</span><span class="p">:</span> <span class="c1"># no need to proceed</span>
        <span class="k">return</span> <span class="n">citations</span>

    <span class="c1"># determine where to break chains of id. citations</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span> <span class="c1"># break at full or short citations</span>
        <span class="n">id_break_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">id_break_regex</span><span class="p">:</span> <span class="c1">#also break at specified regexes</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">id_break_regex</span><span class="p">)</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">id_break_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">id_break_indices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">id_break_indices</span><span class="p">))</span>

    <span class="c1"># loop through all citations to find their id citations</span>
    <span class="n">id_citations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="c1"># find the next id break point</span>
        <span class="n">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">id_break_indices</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">end_point</span> <span class="o">=</span> <span class="n">index</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_point</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">id_break_indices</span> <span class="o">=</span> <span class="n">id_break_indices</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
        <span class="c1"># get each citation's id citations until the break point</span>
        <span class="n">id_citations</span> <span class="o">+=</span> <span class="n">citation</span><span class="o">.</span><span class="n">_get_id_citations</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span> <span class="n">end_point</span><span class="o">=</span><span class="n">end_point</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">_sort_and_remove_overlaps</span><span class="p">(</span><span class="n">citations</span> <span class="o">+</span> <span class="n">id_citations</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.load_yaml">

<code class="highlight language-python"><span class="n">load_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">use_generic_id</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Import templates from the specified YAML file into the citator.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td><code>str</code></td>
<td>
<p>path to the YAML file to load</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>use_generic_id</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to append the citator's generic_id</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">load_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">use_generic_id</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Import templates from the specified YAML file into the citator.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: path to the YAML file to load</span>
<span class="sd">        use_generic_id: Whether to append the citator's generic_id</span>
<span class="sd">        citation format to the loaded templates.</span>
<span class="sd">    """</span>
    <span class="n">yaml_text</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">yaml_dict</span> <span class="o">=</span> <span class="n">safe_load</span><span class="p">(</span><span class="n">yaml_text</span><span class="p">)</span>

    <span class="c1"># read each item in the YAML into a new template</span>
    <span class="k">for</span> <span class="n">template_name</span><span class="p">,</span> <span class="n">template_data</span> <span class="ow">in</span> <span class="n">yaml_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># if regex is specified in singular form, convert it to a</span>
        <span class="c1"># list with one item, for sake of consistency with multiple-</span>
        <span class="c1"># regex templates.</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'regex'</span><span class="p">,</span> <span class="s1">'broadRegex'</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">template_data</span><span class="p">:</span>
              <span class="n">template_data</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s1">'es'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">template_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>

        <span class="c1"># unrelated: if an individual regex is given as a list of</span>
        <span class="c1"># strings (convenient for reusing YAML anchors), concatenate</span>
        <span class="c1"># it to one string.</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'regexes'</span><span class="p">,</span> <span class="s1">'broadRegexes'</span><span class="p">,</span> <span class="s1">'idForms'</span><span class="p">,</span> <span class="s1">'shortForms'</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">template_data</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">template_data</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">template_data</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span>

        <span class="c1"># make the template and add it to the citator, adding the</span>
        <span class="c1"># generic id-form citation if applicable</span>
        <span class="n">new_template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">template_name</span><span class="p">,</span> <span class="o">**</span><span class="n">template_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">use_generic_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_id</span>
            <span class="c1"># weird bug: without this next check, the generic id</span>
            <span class="c1"># gets added upwards of 44 times even though the code</span>
            <span class="c1"># appears to run only once</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_template</span><span class="o">.</span><span class="n">idForms</span>
        <span class="p">):</span>
            <span class="n">new_template</span><span class="o">.</span><span class="n">idForms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generic_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">templates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_template</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citator.lookup">

<code class="highlight language-python"><span class="n">lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">broad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Convenience method to get the first citation from the first
matching template, or None.</p>
<p>This is meant for cases where false positives are not an issue,
so it uses broadRegex and case-insensitive matching by default.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>broad</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to use case-insensitive regex matching and,
if available, each template's broadRegex.</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>str</code></td>
<td>
<p>The text to scan for a citation</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Citation</code></td>
<td>
<p>A single citation object, or None</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">broad</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Citation</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Convenience method to get the first citation from the first</span>
<span class="sd">    matching template, or None.</span>

<span class="sd">    This is meant for cases where false positives are not an issue,</span>
<span class="sd">    so it uses broadRegex and case-insensitive matching by default.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        broad: Whether to use case-insensitive regex matching and,</span>
<span class="sd">            if available, each template's broadRegex.</span>
<span class="sd">        query: The text to scan for a citation</span>
<span class="sd">    Returns:</span>
<span class="sd">        A single citation object, or None</span>
<span class="sd">    """</span>
    <span class="k">for</span> <span class="n">template</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">templates</span><span class="p">:</span>
        <span class="n">citation</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">get_citations</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">broad</span><span class="o">=</span><span class="n">broad</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">citation</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="template">Template</h2>
<div class="doc doc-object doc-class">
<div class="doc doc-contents first">
<p>A pattern to recognize a single kind of citation and generate
URLs from matches.</p>
<p>In most cases, it is more useful to use the Citator class to load
templates from YAML files and apply them en masse, rather than use
the Template class directly.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Template.__init__">

<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regexes</span><span class="p">,</span> <span class="n">URL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">broadRegexes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idForms</span><span class="o">=</span><span class="p">[],</span> <span class="n">shortForms</span><span class="o">=</span><span class="p">[],</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{},</span> <span class="n">operations</span><span class="o">=</span><span class="p">[],</span> <span class="n">parent_citation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_is_id</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h3>
<div class="doc doc-contents ">
<p>Template constructor. Primarily meant for use in loading YAML
files and dynamically generating shortform templates, but can be
run directly if needed.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>The name of this template</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>regexes</code></td>
<td><code>list</code></td>
<td>
<p>A list of one or more regexes that this template will
match. Each regex should be provided as a string, and
should include one or more named capture groups
(i.e. "tokens") that will be used to generate the URL.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>URL</code></td>
<td><code></code></td>
<td>
<p>The template by which to generate URLs from citation
matches. Placeholders in {curly braces} will be replaced
by the value of the token with the same name, after that
token has been processed by the template</p>
<p>The URL template can be provided either as as a string
or as a list of strings to concatenate. In the latter
case, if a list item contains a placeholder for which
no value is set, the list item will be skipped.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>defaults</code></td>
<td><code>dict</code></td>
<td>
<p>A dictionary of tokens and corresponding default
values which should be set if the token's value is not
otherwise set by a regex capture group.</p>
</td>
<td><code>{}</code></td>
</tr>
<tr>
<td><code>operations</code></td>
<td><code>list</code></td>
<td>
<p>A list of operations to perform on the tokens,
in sequence, to transform them from <code>captured_tokens</code> to
<code>processed_tokens</code>, the tokens that are used for URL
generation.</p>
<p>Each operation must specify a <code>token</code> for its input. It
will also be used as the output of the operation, unless
<code>output</code> is specified. If the specified input token is
not set, the operation will be skipped.</p>
<p>The supported operations are <code>case</code>, <code>sub</code>, <code>lookup</code>,
<code>optionalLookup</code>, <code>lpad</code>, and <code>numberFormat</code>.</p>
<p>The <code>case</code> operation outputs the input token, set to the
specified capitalization, either 'upper', 'lower', or
'title'.</p>
<p>The <code>sub</code> operation performs a regex substitution. It
requires a list of two strings; the first is the regex
to match in the input token, and the second is the text
to replace each match with.</p>
<p>The <code>lookup</code> operation tries to match the input against
a series of dictionary keys (using case-insensitive
regex), and set the output to the corresponding value.
If the dictionary does not contain a matching key, the
entire template match will retroactively fail.
<code>optionalLookup</code> works the same way, except that failed
lookups will not cause the template to fail, and will
simply leave tokens unmodified.</p>
<p>The <code>numberFormat</code> operation assumes that the input
token is a number, either in digit form or Roman
numerals. It outputs the same number, converted to the
specified number format, either 'roman' or 'digit'.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>shortForms</code></td>
<td><code>list</code></td>
<td>
<p>A list of regex templates to generate regexes
that recognize short-forms of a parent long-form
citation that has appeared earlier in the text.</p>
<p>Any named section in {curly braces} will be replaced by
the value of the corresponding token from the parent
citation. So if a template detects a longform citation to
"372 U.S. 335" and has a shortform <code>{volume} {reporter}
at (?P&lt;pincite&gt;\d+)</code>, it will generate the following
regex: <code>372 U.S. at (?P&lt;pincite&gt;\d+)</code>.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>idForms</code></td>
<td><code>list</code></td>
<td>
<p>Think "id.", not ID. Identical to shortForms,
except that these regexes will only match until the
next different citation or other interruption.</p>
</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>parent_citation</code></td>
<td><code>Citation</code></td>
<td>
<p>The citation, if any, that this template
was created as a shortform of. This argument is
for dynamically-generated templates, and there is usually
no need to use it manually.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regexes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">URL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">broadRegexes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">idForms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">shortForms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">parent_citation</span><span class="p">:</span> <span class="n">Citation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">_is_id</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Template constructor. Primarily meant for use in loading YAML</span>
<span class="sd">    files and dynamically generating shortform templates, but can be</span>
<span class="sd">    run directly if needed.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: The name of this template</span>

<span class="sd">        regexes: A list of one or more regexes that this template will</span>
<span class="sd">            match. Each regex should be provided as a string, and</span>
<span class="sd">            should include one or more named capture groups</span>
<span class="sd">            (i.e. "tokens") that will be used to generate the URL.</span>

<span class="sd">        URL: The template by which to generate URLs from citation</span>
<span class="sd">            matches. Placeholders in {curly braces} will be replaced</span>
<span class="sd">            by the value of the token with the same name, after that</span>
<span class="sd">            token has been processed by the template</span>

<span class="sd">            The URL template can be provided either as as a string</span>
<span class="sd">            or as a list of strings to concatenate. In the latter</span>
<span class="sd">            case, if a list item contains a placeholder for which</span>
<span class="sd">            no value is set, the list item will be skipped.</span>

<span class="sd">        defaults: A dictionary of tokens and corresponding default</span>
<span class="sd">            values which should be set if the token's value is not</span>
<span class="sd">            otherwise set by a regex capture group.</span>

<span class="sd">        operations: A list of operations to perform on the tokens,</span>
<span class="sd">            in sequence, to transform them from `captured_tokens` to</span>
<span class="sd">            `processed_tokens`, the tokens that are used for URL</span>
<span class="sd">            generation.</span>

<span class="sd">            Each operation must specify a `token` for its input. It</span>
<span class="sd">            will also be used as the output of the operation, unless</span>
<span class="sd">            `output` is specified. If the specified input token is</span>
<span class="sd">            not set, the operation will be skipped.</span>

<span class="sd">            The supported operations are `case`, `sub`, `lookup`,</span>
<span class="sd">            `optionalLookup`, `lpad`, and `numberFormat`.</span>

<span class="sd">            The `case` operation outputs the input token, set to the</span>
<span class="sd">            specified capitalization, either 'upper', 'lower', or</span>
<span class="sd">            'title'.</span>

<span class="sd">            The `sub` operation performs a regex substitution. It</span>
<span class="sd">            requires a list of two strings; the first is the regex</span>
<span class="sd">            to match in the input token, and the second is the text</span>
<span class="sd">            to replace each match with.</span>

<span class="sd">            The `lookup` operation tries to match the input against</span>
<span class="sd">            a series of dictionary keys (using case-insensitive</span>
<span class="sd">            regex), and set the output to the corresponding value.</span>
<span class="sd">            If the dictionary does not contain a matching key, the</span>
<span class="sd">            entire template match will retroactively fail.</span>
<span class="sd">            `optionalLookup` works the same way, except that failed</span>
<span class="sd">            lookups will not cause the template to fail, and will</span>
<span class="sd">            simply leave tokens unmodified.</span>

<span class="sd">            The `numberFormat` operation assumes that the input</span>
<span class="sd">            token is a number, either in digit form or Roman</span>
<span class="sd">            numerals. It outputs the same number, converted to the</span>
<span class="sd">            specified number format, either 'roman' or 'digit'.</span>

<span class="sd">        shortForms: A list of regex templates to generate regexes</span>
<span class="sd">            that recognize short-forms of a parent long-form</span>
<span class="sd">            citation that has appeared earlier in the text.</span>

<span class="sd">            Any named section in {curly braces} will be replaced by</span>
<span class="sd">            the value of the corresponding token from the parent</span>
<span class="sd">            citation. So if a template detects a longform citation to</span>
<span class="sd">            "372 U.S. 335" and has a shortform `{volume} {reporter}</span>
<span class="sd">            at (?P&lt;pincite&gt;\d+)`, it will generate the following</span>
<span class="sd">            regex: `372 U.S. at (?P&lt;pincite&gt;\d+)`.</span>

<span class="sd">        idForms: Think "id.", not ID. Identical to shortForms,</span>
<span class="sd">            except that these regexes will only match until the</span>
<span class="sd">            next different citation or other interruption.</span>

<span class="sd">        parent_citation: The citation, if any, that this template</span>
<span class="sd">            was created as a shortform of. This argument is</span>
<span class="sd">            for dynamically-generated templates, and there is usually</span>
<span class="sd">            no need to use it manually.</span>
<span class="sd">    """</span>
    <span class="c1"># Basic values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regexes</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">regexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_id</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">_is_id</span>
    <span class="k">if</span> <span class="n">URL</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">URL</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="p">[</span><span class="n">URL</span><span class="p">]</span>
    <span class="c1"># Supplemental regexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broadRegexes</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">broadRegexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">idForms</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">idForms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shortForms</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">shortForms</span>
    <span class="c1"># String operators</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">defaults</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">operations</span>

    <span class="c1"># Extra data for shortform citations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent_citation</span><span class="p">:</span> <span class="n">Citation</span> <span class="o">=</span> <span class="n">parent_citation</span>

    <span class="c1"># hack: prevent all regexes from matching mid-word</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'regexes'</span><span class="p">,</span> <span class="s1">'broadRegexes'</span><span class="p">,</span> <span class="s1">'idForms'</span><span class="p">,</span> <span class="s1">'shortForms'</span><span class="p">]:</span>
        <span class="n">regex_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regex_list</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">regex_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">r</span><span class="s1">'(\b|^)'</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">regex_list</span><span class="p">))</span>

    <span class="c1"># dictionaries of compiled regexes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_compiled_regexes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_compiled_broadRegexes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Template.get_citations">

<code class="highlight language-python"><span class="n">get_citations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">broad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Generator to return all citations the template finds in text.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>The text to scan for a citation</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>broad</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to use case-insensitive regex matching and,
if available, the template's broadRegex.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>span</code></td>
<td><code>tuple</code></td>
<td>
<p>A tuple of one or two values determining
the start and end index of where in the text to search
for citations. Defaults to (0,) to scan the entire text.</p>
</td>
<td><code>(0,)</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Iterable</code></td>
<td>
<p>Generator that yields each citation the template finds in the
    text, or None.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_citations</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">broad</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">span</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Generator to return all citations the template finds in text.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        text: The text to scan for a citation</span>
<span class="sd">        broad: Whether to use case-insensitive regex matching and,</span>
<span class="sd">            if available, the template's broadRegex.</span>
<span class="sd">        span: A tuple of one or two values determining</span>
<span class="sd">            the start and end index of where in the text to search</span>
<span class="sd">            for citations. Defaults to (0,) to scan the entire text.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Generator that yields each citation the template finds in the</span>
<span class="sd">            text, or None.</span>
<span class="sd">    """</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">regex_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regexes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">broad</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">broadRegexes</span><span class="p">:</span>
        <span class="n">regex_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broadRegexes</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">regex_count</span><span class="p">):</span>
        <span class="c1">#print(f'scanning regex {index} for template {self}')</span>
        <span class="n">matches</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compiled_re</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">broad</span><span class="p">)</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">*</span><span class="n">span</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">citation</span> <span class="o">=</span> <span class="n">Citation</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># skip citations where lookup failed:</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">citation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">citation</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">citation</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Template.lookup">

<code class="highlight language-python"><span class="n">lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">broad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Returns the first citation it finds in the text, or None.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>The text to scan for a citation.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>broad</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to use case-insensitive regex matching
and, if available, the template's broadRegex.</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>span</code></td>
<td><code>tuple</code></td>
<td>
<p>A tuple of one or two values determining
the start and end index of where in the text to search
for citations. Defaults to (0,) to scan the entire text.</p>
</td>
<td><code>(0,)</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Citation</code></td>
<td>
<p>The first citation this template finds in the scanned text,
or None.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">lookup</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">broad</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">span</span><span class="p">:</span> <span class="nb">tuple</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Citation</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Returns the first citation it finds in the text, or None.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        text: The text to scan for a citation.</span>
<span class="sd">        broad: Whether to use case-insensitive regex matching</span>
<span class="sd">            and, if available, the template's broadRegex.</span>
<span class="sd">        span: A tuple of one or two values determining</span>
<span class="sd">            the start and end index of where in the text to search</span>
<span class="sd">            for citations. Defaults to (0,) to scan the entire text.</span>
<span class="sd">    Returns:</span>
<span class="sd">        The first citation this template finds in the scanned text,</span>
<span class="sd">        or None.</span>
<span class="sd">    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_citations</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">broad</span><span class="o">=</span><span class="n">broad</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="n">span</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="citation">Citation</h2>
<div class="doc doc-object doc-class">
<div class="doc doc-contents first">
<p>A single citation found in text.</p>
<p><strong>Attributes:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>The text of the citation itself, like "42 USC § 1988(b)"</p>
</td>
</tr>
<tr>
<td><code>span</code></td>
<td><code>tuple</code></td>
<td>
<p>The beginning and end positions of this citation in the
source text.</p>
</td>
</tr>
<tr>
<td><code>template</code></td>
<td><code>Template</code></td>
<td>
<p>The template which recognized this citation</p>
</td>
</tr>
<tr>
<td><code>tokens</code></td>
<td><code>dict</code></td>
<td>
<p>Dictionary of the named capture groups from the regex
this citation matched. For "id." and "shortform" citations,
this includes tokens carried over from the parent citation.</p>
</td>
</tr>
<tr>
<td><code>processed_tokens</code></td>
<td><code>dict</code></td>
<td>
<p>Dictionary of tokens after they have been
modified via the template's processes.</p>
</td>
</tr>
<tr>
<td><code>URL</code></td>
<td><code>str</code></td>
<td>
<p>The URL where a user can read this citation online</p>
</td>
</tr>
<tr>
<td><code>authority</code></td>
<td><code></code></td>
<td>
<p>The Authority that this citation is a reference to.
This attribute is not set until list_authorities() is run.</p>
</td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citation.__init__">

<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h3>
<div class="doc doc-contents ">
<p>For internal use. There should be no need to create citations
by means other than a Citator or Template object.</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    For internal use. There should be no need to create citations</span>
<span class="sd">    by means other than a Citator or Template object.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span> <span class="n">Template</span> <span class="o">=</span> <span class="n">template</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># idForm and shortForm citations get values from parent citation</span>
    <span class="c1"># except where their regexes include space for those values</span>
    <span class="k">if</span> <span class="n">template</span><span class="o">.</span><span class="n">parent_citation</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">parent_citation</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processed_tokens</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">_process_tokens</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_url</span><span class="p">()</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Citation.get_link">

<code class="highlight language-python"><span class="n">get_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">})</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Return citation's link element, with given attributes</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">}):</span>
    <span class="sd">"""Return citation's link element, with given attributes"""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">:</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s1">'href'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">URL</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">'href'</span><span class="p">]</span>
    <span class="n">attr_str</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">attr_str</span> <span class="o">+=</span> <span class="s1">' </span><span class="si">%s</span><span class="s1">="</span><span class="si">%s</span><span class="s1">"'</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">'&lt;a</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/a&gt;'</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr_str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="authority">Authority</h2>
<div class="doc doc-object doc-class">
<div class="doc doc-contents first">
<p>A single source cited one or more times in a text.</p>
<p><strong>Attributes:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>defining_tokens</code></td>
<td><code>dict</code></td>
<td>
<p>A dictionary of tokens that define this
authority, such that any citations with incompatible
token values will not match it. Note that this uses
processed_tokens (those which have been modified by
the template's operations).</p>
</td>
</tr>
<tr>
<td><code>template</code></td>
<td><code>Template</code></td>
<td>
<p>The template which found all the citations to this
authority</p>
</td>
</tr>
<tr>
<td><code>citations</code></td>
<td><code>list</code></td>
<td>
<p>The list of all the citations that refer to
this authority.</p>
</td>
</tr>
<tr>
<td><code>base_citation</code></td>
<td><code>Citation</code></td>
<td>
<p>A citation object representing the hypothetical
generic citation to this authority.</p>
</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>
<p>The text of base_citation</p>
</td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Authority.__init__">

<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_cite</span><span class="p">,</span> <span class="n">allowed_differences</span><span class="o">=</span><span class="p">[])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h3>
<div class="doc doc-contents ">
<p>Define an authority by providing a single long-form citation,
and the list of tokens which, if present in the citation, should
be discarded from the definition of the authority.</p>
<p>Generates a base_citation to represent the generic instance of
this authority.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>first_cite</code></td>
<td><code>Citation</code></td>
<td>
<p>A long-form citation object representing the
first and archetypal citation to this authority. The
first_cite will be added as the first entry in the
authority's citation list, and it will be used as the
basis to generate the authority's base_citation.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>allowed_differences</code></td>
<td><code>list</code></td>
<td>
<p>A list of tokens whose values can
differ among citations to the same authority</p>
</td>
<td><code>[]</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_cite</span><span class="p">:</span> <span class="n">Citation</span><span class="p">,</span> <span class="n">allowed_differences</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">"""</span>
<span class="sd">    Define an authority by providing a single long-form citation,</span>
<span class="sd">    and the list of tokens which, if present in the citation, should</span>
<span class="sd">    be discarded from the definition of the authority.</span>

<span class="sd">    Generates a base_citation to represent the generic instance of</span>
<span class="sd">    this authority.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        first_cite: A long-form citation object representing the</span>
<span class="sd">            first and archetypal citation to this authority. The</span>
<span class="sd">            first_cite will be added as the first entry in the</span>
<span class="sd">            authority's citation list, and it will be used as the</span>
<span class="sd">            basis to generate the authority's base_citation.</span>
<span class="sd">        allowed_differences: A list of tokens whose values can</span>
<span class="sd">            differ among citations to the same authority</span>
<span class="sd">    """</span>
    <span class="n">long_cite</span> <span class="o">=</span> <span class="n">first_cite</span><span class="o">.</span><span class="n">_original_cite</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">:</span> <span class="n">Template</span> <span class="o">=</span> <span class="n">long_cite</span><span class="o">.</span><span class="n">template</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">citations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="n">first_cite</span><span class="p">]</span>
    <span class="c1"># List the token values that distinguish this authority from</span>
    <span class="c1"># others in the same template. This uses processed tokens, not</span>
    <span class="c1"># raw, so that a citation to "50 U.S. 5" will match</span>
    <span class="c1"># a citation to "50 U. S. 5", etc.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defining_tokens</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">first_cite</span><span class="o">.</span><span class="n">processed_tokens</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">first_cite</span><span class="o">.</span><span class="n">processed_tokens</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_differences</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">defining_tokens</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_cite</span><span class="o">.</span><span class="n">processed_tokens</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="c1"># Next, derive a base citation to represent this authority.</span>
    <span class="c1"># If the first_citation to this authority isn't a longform, use</span>
    <span class="c1"># whatever longform it's a child of.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base_citation</span><span class="p">:</span> <span class="n">Citation</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_derive_base_citation</span><span class="p">(</span><span class="n">long_cite</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_citation</span> <span class="o">=</span> <span class="n">first_cite</span>
    <span class="c1"># Set other instance variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_citation</span><span class="o">.</span><span class="n">text</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_citation</span><span class="o">.</span><span class="n">URL</span>
    <span class="c1"># finally, give the first citation a reference to this authority</span>
    <span class="n">first_cite</span><span class="o">.</span><span class="n">authority</span> <span class="o">=</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Authority.include">

<code class="highlight language-python"><span class="n">include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">citation</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Adds the citation to this authority's list of citations. Also,
adds the <code>authority</code> tag to the citation, referring back to this
authority.</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">citation</span><span class="p">):</span>
    <span class="sd">"""Adds the citation to this authority's list of citations. Also,</span>
<span class="sd">    adds the `authority` tag to the citation, referring back to this</span>
<span class="sd">    authority."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">citations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="n">citation</span><span class="o">.</span><span class="n">authority</span> <span class="o">=</span> <span class="bp">self</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="citeurl.Authority.matches">

<code class="highlight language-python"><span class="n">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">citation</span><span class="p">)</span></code>


      </h3>
<div class="doc doc-contents ">
<p>Checks whether a given citation matches the template and defining
tokens of this authority.</p>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">citation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Checks whether a given citation matches the template and defining</span>
<span class="sd">    tokens of this authority.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">citation</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defining_tokens</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">citation</span><span class="o">.</span><span class="n">processed_tokens</span>
            <span class="ow">or</span> <span class="n">citation</span><span class="o">.</span><span class="n">processed_tokens</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
<h2 id="insert_links">insert_links()</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Given a text and a list of citations found in it, return a text
with an HTML hyperlink inserted for each citation.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>citations</code></td>
<td><code>list</code></td>
<td>
<p>A list of citation objects found in the text</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>str</code></td>
<td>
<p>The text the citations were found in</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>attrs</code></td>
<td><code>dict</code></td>
<td>
<p>HTML tag attributes (like css class, rel, etc)
to give each inserted hyperlink.</p>
</td>
<td><code>{'class': 'citation'}</code></td>
</tr>
<tr>
<td><code>link_detailed_ids</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert hyperlinks for citations
like "Id. at 30."</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>link_plain_ids</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert hyperlinks for simple repeat
citations like "id."</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>url_optional</code></td>
<td><code>bool</code></td>
<td>
<p>Whether to insert link elements for citations that
do not have an associated URL</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>str</code></td>
<td>
<p>The input text, with HTML links inserted for each citation</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">insert_links</span><span class="p">(</span>
    <span class="n">citations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="p">{</span><span class="s1">'class'</span><span class="p">:</span> <span class="s1">'citation'</span><span class="p">},</span>
    <span class="n">link_detailed_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">link_plain_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">url_optional</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Given a text and a list of citations found in it, return a text</span>
<span class="sd">    with an HTML hyperlink inserted for each citation.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        citations: A list of citation objects found in the text</span>
<span class="sd">        text: The text the citations were found in</span>
<span class="sd">        attrs: HTML tag attributes (like css class, rel, etc)</span>
<span class="sd">            to give each inserted hyperlink.</span>
<span class="sd">        link_detailed_ids: Whether to insert hyperlinks for citations</span>
<span class="sd">            like "Id. at 30."</span>
<span class="sd">        link_plain_ids: Whether to insert hyperlinks for simple repeat</span>
<span class="sd">            citations like "id."</span>
<span class="sd">        url_optional: Whether to insert link elements for citations that</span>
<span class="sd">            do not have an associated URL</span>
<span class="sd">    Returns:</span>
<span class="sd">        The input text, with HTML links inserted for each citation</span>
<span class="sd">    """</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="c1"># by default, skip citations without URLs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">citation</span><span class="o">.</span><span class="n">URL</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">url_optional</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">citation</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">is_id</span><span class="p">:</span>
            <span class="c1"># check whether the matched citation is from a template that</span>
            <span class="c1"># has any named capture groups. If it doesn't, it's a</span>
            <span class="c1"># "plain id." and should normally be skipped</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">'(?P&lt;'</span> <span class="ow">in</span> <span class="n">citation</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">_compiled_re</span><span class="p">()</span><span class="o">.</span><span class="n">pattern</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">link_plain_ids</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">link_detailed_ids</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="n">link</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">get_link</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">)</span>

        <span class="c1"># insert each link into the proper place by offsetting later</span>
        <span class="c1"># citations by however many extra characters are added by each</span>
        <span class="n">cite_start</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="n">cite_end</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">text</span><span class="p">[:</span><span class="n">cite_start</span><span class="p">],</span> <span class="n">link</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">cite_end</span><span class="p">:]])</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">link</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">citation</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">text</span>
</code></pre>
</div>
</details>
</div>
</div>
<h2 id="list_authorities">list_authorities()</h2>
<div class="doc doc-object doc-function">
<div class="doc doc-contents first">
<p>Combine a list of citations into a list of authorities, each
of which represents all the citations to a particular source.</p>
<p>As a side-effect, this also gives each citation an <code>authority</code>
attribute referring to the proper authority.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>citations</code></td>
<td><code>list</code></td>
<td>
<p>The list of citations to combine</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>irrelevant_tokens</code></td>
<td><code>list</code></td>
<td>
<p>A list of tokens whose values may 
differ among citations to the same authority.</p>
</td>
<td><code>['subsection', 'subdivision', 'clause', 'pincite', 'pincite_end', 'footnote']</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>A list of authority objects, sorted by the number of citations
that refer to each, from most to least.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>citeurl/__init__.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">list_authorities</span><span class="p">(</span>
    <span class="n">citations</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> 
    <span class="n">irrelevant_tokens</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="n">NON_AUTHORITY_TOKENS</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Combine a list of citations into a list of authorities, each</span>
<span class="sd">    of which represents all the citations to a particular source.</span>

<span class="sd">    As a side-effect, this also gives each citation an `authority`</span>
<span class="sd">    attribute referring to the proper authority.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        citations: The list of citations to combine</span>
<span class="sd">        irrelevant_tokens: A list of tokens whose values may </span>
<span class="sd">            differ among citations to the same authority.</span>
<span class="sd">    Returns:</span>
<span class="sd">        A list of authority objects, sorted by the number of citations</span>
<span class="sd">        that refer to each, from most to least.</span>
<span class="sd">    """</span>
    <span class="n">authorities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">citation</span> <span class="ow">in</span> <span class="n">citations</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authority</span> <span class="ow">in</span> <span class="n">authorities</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">authority</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="n">citation</span><span class="p">):</span>
                <span class="n">authority</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">authorities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Authority</span><span class="p">(</span><span class="n">citation</span><span class="p">,</span> <span class="n">irrelevant_tokens</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">authority_sort_key</span><span class="p">(</span><span class="n">authority</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">authority</span><span class="o">.</span><span class="n">citations</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">authorities</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">authority_sort_key</span><span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../frontends/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                CiteURL Frontends
              </div>
            </div>
          </a>
        
        
          <a href="../template-yamls/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Writing Your Own Templates
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>