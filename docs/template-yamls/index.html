
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>Writing Your Own Templates - CiteURL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="pink">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#writing-your-own-templates" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CiteURL" class="md-header__button md-logo" aria-label="CiteURL" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CiteURL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Writing Your Own Templates
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/raindrum/citeurl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CiteURL" class="md-nav__button md-logo" aria-label="CiteURL" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    CiteURL
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/raindrum/citeurl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../frontends/" class="md-nav__link">
        CiteURL Frontends
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../library/" class="md-nav__link">
        Library Reference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Writing Your Own Templates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Writing Your Own Templates
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basic-template-format" class="md-nav__link">
    The Basic Template Format
  </a>
  
    <nav class="md-nav" aria-label="The Basic Template Format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regex-complications" class="md-nav__link">
    Regex Complications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-complications" class="md-nav__link">
    URL Complications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-processing" class="md-nav__link">
    Token Processing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recognizing-shortform-citations" class="md-nav__link">
    Recognizing Shortform Citations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous-keys" class="md-nav__link">
    Miscellaneous Keys
  </a>
  
    <nav class="md-nav" aria-label="Miscellaneous Keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defaults" class="md-nav__link">
    defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadregex" class="md-nav__link">
    broadRegex
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basic-template-format" class="md-nav__link">
    The Basic Template Format
  </a>
  
    <nav class="md-nav" aria-label="The Basic Template Format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regex-complications" class="md-nav__link">
    Regex Complications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-complications" class="md-nav__link">
    URL Complications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-processing" class="md-nav__link">
    Token Processing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recognizing-shortform-citations" class="md-nav__link">
    Recognizing Shortform Citations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous-keys" class="md-nav__link">
    Miscellaneous Keys
  </a>
  
    <nav class="md-nav" aria-label="Miscellaneous Keys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defaults" class="md-nav__link">
    defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadregex" class="md-nav__link">
    broadRegex
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/raindrum/citeurl/edit/main/docs_source/template-yamls.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="writing-your-own-templates">Writing Your Own Templates</h1>
<p>CiteURL supports a number of citation formats out-of-the box, and I try to add more when I can. However, it can never support every possible kind of citation, especially for local laws and countries outside the United States. For that reason, CiteURL is designed to let you write your own citation templates in YAML format.</p>
<p>This page details how to write these template files. Before you proceed, make sure you're at least a little familiar with <a href="https://docs.python.org/3/howto/regex.html">Python regex</a>, because the templates rely heavily on it. You'll also need some basic knowledge of <a href="https://www.w3schools.io/file/yaml-introduction/">YAML</a>.</p>
<p><strong>Note</strong>: <a href="https://github.com/raindrum/citeurl/blob/main/citeurl/builtin-templates.yaml">CiteURL's built-in templates</a> are written in the same YAML format described on this page, so they can serve as a reference when you're writing your own.</p>
<h2 id="the-basic-template-format">The Basic Template Format</h2>
<p>Here is a simplified example of a template that you might write to recognize citations to the U.S. Code:</p>
<div class="highlight"><pre><span></span><code><span class="nt">United States Code</span><span class="p">:</span>
  <span class="nt">regex</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(?P&lt;title&gt;\d+) USC § (?P&lt;section&gt;\d+)</span>
  <span class="nt">URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.law.cornell.edu/uscode/text/{title}/{section}</span>
</code></pre></div>
<p>Because of what's in the 'regex' key, this citation template recognizes any series of one or more digits, followed by " USC § ," followed by another series of digits. It knows that the first string of digits is something called a "title" and the second is a "section." We will call these stored values "tokens."</p>
<p>Any tokens that are captured in the regex can be used to fill placeholders (identified by curly braces) in the URL template, as shown above.</p>
<p><strong>Note</strong> that although this example inserts tokens into the URL unmodified, it is also possible to process the tokens first using one or more <a href="#token-processing">operations</a>. Also note that this template only recognizes full, long-form citations to the U.S. Code, but you can add additional information to help it <a href="#recognizing-shortform-citations">recognize shortform citations</a> that follow the original citation.</p>
<p>But before we get into that, it's important to know a bit more about how the regex and URL fields work:</p>
<h3 id="regex-complications">Regex Complications</h3>
<p>In the example above, the template recognizes only one regex, and that regex is provided as a single string. This is perfectly valid, but CiteURL templates also allow for more complex regex definitions.</p>
<p>First, it's possible to provide a regex as a list rather than a single strings, so that the actual regex will be composed of each list entry combined together. string, like so:</p>
<div class="highlight"><pre><span></span><code><span class="nt">United States Code</span><span class="p">:</span>
  <span class="nt">regex</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nl">&amp;title</span> <span class="s">&#39;(?P&lt;title&gt;\d+)&#39;</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;</span><span class="nv"> </span><span class="s">USC</span><span class="nv"> </span><span class="s">&#39;</span>
    <span class="p p-Indicator">-</span> <span class="nl">&amp;section</span> <span class="s">&#39;§</span><span class="nv"> </span><span class="s">(?P&lt;section&gt;\d+)&#39;</span>
  <span class="nt">URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.law.cornell.edu/uscode/text/{title}/{section}</span>
</code></pre></div>
<p>Functionally, this template works exactly like the last one. However, because the regex was broken up into a list of components, it was possible to define the <code>title</code> and <code>section</code> components as <a href="https://medium.com/@kinghuang/docker-compose-anchors-aliases-extensions-a1e4105d70bd">YAML anchors</a> that can be reused later, by writing <code>*title</code> or <code>*section</code>, respectively. When writing a large number of templates, this can save a lot of time, as well as make them easier to maintain.</p>
<p>The second regex complication to know about is that it is possible to give a template <em>more than one</em> regex, such that the template will recognize a citation that matches any of its alternate regexes. Note that it is usually preferable to write a more flexible <em>single</em> regex. However, in some cases this is impossible due to regex limitations, such as the fact that named capture groups must appear in a fixed order.</p>
<p>To provide multiple regexes, replace the "regex" key with "regexes," as shown here:</p>
<div class="highlight"><pre><span></span><code><span class="nt">United States Code</span><span class="p">:</span>
  <span class="nt">regexes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;(?P&lt;title&gt;\d+)</span><span class="nv"> </span><span class="s">USC</span><span class="nv"> </span><span class="s">§</span><span class="nv"> </span><span class="s">(?P&lt;section&gt;\d+)&#39;</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;section</span><span class="nv"> </span><span class="s">(?P&lt;section&gt;\d+)</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">title</span><span class="nv"> </span><span class="s">(?P&lt;title&gt;\d+)</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">U\.S\.</span><span class="nv"> </span><span class="s">Code&#39;</span>
  <span class="nt">URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.law.cornell.edu/uscode/text/{title}/{section}</span>
</code></pre></div>
<p>This template uses multiple regexes to make it possible to recognize U.S. Code citations no matter whether the title is specified before the section, or vice versa.</p>
<p>It's important to remember the difference between using multiple regexes and defining one regex in list form. In fact, it is possible to do both at once:</p>
<div class="highlight"><pre><span></span><code><span class="nt">United States Code</span><span class="p">:</span>
  <span class="nt">regexes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nl">&amp;title</span> <span class="s">&#39;(?P&lt;title&gt;\d+)&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;</span><span class="nv"> </span><span class="s">USC</span><span class="nv"> </span><span class="s">&#39;</span><span class="p p-Indicator">,</span> <span class="nl">&amp;section</span> <span class="s">&#39;§</span><span class="nv"> </span><span class="s">(?P&lt;section&gt;\d+)&#39;</span><span class="p p-Indicator">]</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">*section</span><span class="p p-Indicator">,</span> <span class="s">&#39;</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">Title</span><span class="nv"> </span><span class="s">&#39;</span><span class="p p-Indicator">,</span> <span class="nv">*title</span><span class="p p-Indicator">,</span> <span class="s">&#39;</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">United</span><span class="nv"> </span><span class="s">States</span><span class="nv"> </span><span class="s">Code&#39;</span><span class="p p-Indicator">]</span>
  <span class="nt">URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.law.cornell.edu/uscode/text/{title}/{section}</span>
</code></pre></div>
<p>This is functionally equivalent to the previous example, but because the individual regexes are provided in list form, it is possible to reuse the "title" and "section" pieces via YAML anchors, rather than write them twice.</p>
<h3 id="url-complications">URL Complications</h3>
<p>Another important feature is that a template's URL, like its regex(es), can be specified as a list of strings to concatenate. Unlike with regexes, splitting a URL into a list of strings makes it behave differently. Specifically, If a section of the URL contains a placeholder for which no value is set, that whole list item will be omitted from the final URL. For instance, the template below can generate links to specific subsections of the U.S. Code, but if no subsection is specified, it simply links to the overall page for the section itself:</p>
<div class="highlight"><pre><span></span><code><span class="nt">United States Code</span><span class="p">:</span>
  <span class="nt">regex</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(?P&lt;title&gt;\d+) USC § (?P&lt;section&gt;\d+)( \((?P&lt;subsection&gt;[a-z])\)?</span>
  <span class="nt">URL</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;https://www.law.cornell.edu/uscode/text/{title}/{section}&#39;</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;#{subsection}&#39;</span>
</code></pre></div>
<h2 id="token-processing">Token Processing</h2>
<p>In many cases, the tokens matched in a citation won't directly correspond with the values that need to be inserted into the URL placeholder. For example, your template might detect a court reporter called "F. App'x." or "Pa. D. &amp; C.4th", but <a href="https://case.law/">Case.Law</a>'s URL scheme needs those reporters to be called "<a href="https://cite.case.law/f-appx/">f-appx</a>" and "<a href="https://cite.case.law/pa-d-c4th/">pa-d-c4th</a>," respectively.</p>
<p>To solve this problem, CiteURL templates can specify <code>operations</code> that will be performed on the dictionary of matched tokens to turn them into a new dictionary (i.e. <code>processed_tokens</code>) before using it to populate the URL.</p>
<p>This example template solves the problem by converting the <code>reporter</code> token to lowercase, deleting some common special characters from it, and then replacing spaces with dashes:</p>
<div class="highlight"><pre><span></span><code><span class="nt">Caselaw Access Project (Simplified)</span><span class="p">:</span>
  <span class="nt">regex</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(?P&lt;volume&gt;\d+) (?P&lt;reporter&gt;(\D|\d(d|th|rd))+?) (?P&lt;page&gt;\d+)</span>
  <span class="nt">operations</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">token</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reporter</span>
      <span class="nt">case</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lower</span>
    <span class="p p-Indicator">-</span> <span class="nt">token</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reporter</span>
      <span class="nt">sub</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;[.()&amp;,&#39;]&quot;</span><span class="p p-Indicator">,</span> <span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span>
    <span class="p p-Indicator">-</span> <span class="nt">token</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reporter</span>
      <span class="nt">sub</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;</span><span class="nv"> </span><span class="s">&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;-&#39;</span><span class="p p-Indicator">]</span>
  <span class="nt">URL</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://cite.case.law/{reporter}/{volume}/{page}</span>
</code></pre></div>
<p>As shown above, a template's <code>operations</code> value is a list of operations that will be performed in sequence. Each operation is a dictionary that must specify a <code>token</code> to process, and the kind of operation to perform. Operations process a token in place by default, but if an <code>output</code> is specified, that token will be set or modified instead.</p>
<p>The above example shows two kinds of operation: case modification (<code>case</code>), and regex substitution (<code>sub</code>), but CiteURL supports others as well:</p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Description</th>
<th>Required Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>case</code></td>
<td>sets the input token to the specified capitalization</td>
<td><code>upper</code>, <code>lower</code>, or <code>title</code></td>
</tr>
<tr>
<td><code>sub</code></td>
<td>replaces all instances of the provided regex pattern with the replacement string</td>
<td><code>[PATTERN, REPL]</code></td>
</tr>
<tr>
<td><code>lookup</code></td>
<td>uses case-insensitive regex matching to check the token against each pattern until it fully matches one of them, in which case it outputs the corresponding replacement string. If no pattern is matched, it causes the entire template match to retroactively fail, as if there had never been a regex match in the first place.</td>
<td><code>{PATTERN: REPL, PATTERN: REPL ...}</code></td>
</tr>
<tr>
<td><code>optionalLookup</code></td>
<td>same as <code>lookup</code>, except that if the lookup fails, it simply proceeds without modifying any tokens</td>
<td><code>{PATTERN: REPL, PATTERN: REPL ...}</code></td>
</tr>
<tr>
<td><code>lpad</code></td>
<td>adds zeros to the beginning of the token until it is the specified length</td>
<td>an integer</td>
</tr>
<tr>
<td><code>numberFormat</code></td>
<td>assumes that the token is an integer in digit or roman numeral form, and converts it to the specified form, irrespective of which format it was originally in. The outputted roman numerals are capitalized.</td>
<td><code>roman</code> or <code>digit</code></td>
</tr>
</tbody>
</table>
<p>One final note: If an operation's input token has not been set (as distinct from being set to an empty string), the operation will be skipped.</p>
<h2 id="recognizing-shortform-citations">Recognizing Shortform Citations</h2>
<p>Often, once a particular authority is cited once, subsequent references to it will take a shorter, more contextual format. CiteURL templates can account for these kinds of citations using the <code>shortForms</code> and <code>idForms</code> keys.</p>
<p>Consider the following template:</p>
<div class="highlight"><pre><span></span><code><span class="nt">Federal Supplement</span><span class="p">:</span>
  <span class="nt">regex</span><span class="p">:</span> <span class="s">&#39;(?P&lt;volume&gt;\d+)</span><span class="nv"> </span><span class="s">F\.</span><span class="nv"> </span><span class="s">Supp\.</span><span class="nv"> </span><span class="s">(?P&lt;page&gt;\d+)(,</span><span class="nv"> </span><span class="s">(?P&lt;pincite&gt;\d+))?&#39;</span>
  <span class="nt">idForms</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;Id\.</span><span class="nv"> </span><span class="s">at</span><span class="nv"> </span><span class="s">(?P&lt;pincite&gt;\d+)&#39;</span>
  <span class="nt">shortForms</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;{volume}</span><span class="nv"> </span><span class="s">F\.</span><span class="nv"> </span><span class="s">Supp\.</span><span class="nv"> </span><span class="s">at</span><span class="nv"> </span><span class="s">(?P&lt;pincite&gt;\d+)&#39;</span>
  <span class="nt">URL</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;https://cite.case.law/f-supp/{title}/{page}&#39;</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;#p{pincite}&#39;</span>
</code></pre></div>
<p>If a text cites <em>United States v. An Article Consisting of Boxes of Clacker Balls</em>, 413 F. Supp. 1281 (E.D. Wis. 1976), it CiteURL will recognize it as a full citation because it matches the regex for the Federal Supplement citation template.</p>
<p>When this occurs, it will dynamically generate a <code>shortForm</code> template to recognize citations like "413 F. Supp. at 1289" anywhere in the following text. It will also generate an <code>idForm</code> template that will recognize citations like "<em>Id.</em> at 1284," but which will be deactivated as soon as the text references a different authority.</p>
<p>The <code>idForms</code> and <code>shortForms</code> keys are like the <code>regexes</code> key in that they contain a list of regexes, and each regex may be given as a string or a list of strings. However, they differ from normal regexes in that, like the <code>URL</code> key, they may contain placeholders in curly braces, which will be filled in with the relevant tokens found in the longform citation.</p>
<p>Note that while the <code>URL</code> key uses the tokens after they have been <a href="#token-processing">processed</a>, the placeholders here use the values exactly as captured in the regex, <em>unless</em> the placeholder references a token that only exists after processing.</p>
<h2 id="miscellaneous-keys">Miscellaneous Keys</h2>
<h3 id="defaults">defaults</h3>
<p><code>defaults</code> is a dictionary of tokens whose values will be set to specified values, if they are not set by a named capture group in the matched regex. Defaults are applied prior to any <a href="#token-processing">operations</a>.</p>
<p>For instance, the template below will match citations like "29 USC § 157" as well as citations like "§ 1983", but in the latter case, it assumes that the title is '42' by default.</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">U.S. Code, but especially Title 42</span><span class="p p-Indicator">:</span>
  <span class="nt">regex</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">((?P&lt;title&gt;\d+) USC )?§ (?P&lt;section&gt;\d+)</span>
  <span class="nt">defaults</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span> <span class="s">&#39;42&#39;</span><span class="p p-Indicator">}</span>
</code></pre></div>
<h3 id="broadregex">broadRegex</h3>
<p><code>broadRegex</code> and <code>broadRegexes</code> are identical in format to the <code>regex</code> and <code>regexes</code> keys. They allow you to specify extra regexes that will be used, in addition to the normal regex(es), in contexts like search engines where user convenience is more important than avoiding false positives. </p>
<p>BroadRegexes are used by default in the <a href="../library/#citeurl.Template.lookup">lookup()</a> method, as well as in <a href="../frontends#javascript">JavaScript implementations</a>, though if you are writing templates <em>exclusively</em> for these use cases rather than text processing, it is not important whether you use <code>regexes</code> or <code>broadRegexes</code>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../library/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Library Reference
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.d351de03.min.js", "version": "8.3.8"}</script>
    
    
      <script src="../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
    
  </body>
</html>